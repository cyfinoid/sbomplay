<div id="vulnerability-section" class="independent-section">
    <div class="vulnerability-breakdown">
        <h3>ğŸ”’ Vulnerability Analysis</h3>
        {{#if hasVulnerabilityAnalysis}}
        <div class="vulnerability-actions mb-3">
            <button class="btn btn-primary btn-sm" onclick="viewManager.runBatchVulnerabilityQuery('{{organization|quote}}')">
                <i class="fas fa-search"></i> Re-run Batch Vulnerability Query
            </button>
            <button class="btn btn-info btn-sm" onclick="viewManager.showVulnerabilityCacheStats()">
                <i class="fas fa-database"></i> Cache Stats
            </button>
            <button class="btn btn-warning btn-sm" onclick="viewManager.clearVulnerabilityCache()">
                <i class="fas fa-trash"></i> Clear Cache
            </button>
        </div>
        <div class="vulnerability-stats">
            <div class="vuln-stat-card critical">
                <h4>ğŸš¨ Critical</h4>
                <div class="vuln-number">{{criticalVulnerabilities}}</div>
                <div class="vuln-detail">vulnerabilities</div>
            </div>
            <div class="vuln-stat-card high">
                <h4>âš ï¸ High</h4>
                <div class="vuln-number">{{highVulnerabilities}}</div>
                <div class="vuln-detail">vulnerabilities</div>
            </div>
            <div class="vuln-stat-card medium">
                <h4>âš¡ Medium</h4>
                <div class="vuln-number">{{mediumVulnerabilities}}</div>
                <div class="vuln-detail">vulnerabilities</div>
            </div>
            <div class="vuln-stat-card low">
                <h4>â„¹ï¸ Low</h4>
                <div class="vuln-number">{{lowVulnerabilities}}</div>
                <div class="vuln-detail">vulnerabilities</div>
            </div>
            <div class="vuln-stat-card total">
                <h4>ğŸ“Š Total</h4>
                <div class="vuln-number">{{vulnerablePackages}}</div>
                <div class="vuln-detail">vulnerable packages</div>
            </div>
            <div class="vuln-stat-card rate">
                <h4>ğŸ“ˆ Rate</h4>
                <div class="vuln-number">{{vulnerabilityRate}}%</div>
                <div class="vuln-detail">vulnerability rate</div>
            </div>
        </div>
        {{vulnerableDepsHTML}}
        {{else}}
        <div class="vulnerability-actions mb-3">
            <button class="btn btn-primary btn-sm" onclick="viewManager.runBatchVulnerabilityQuery('{{organization|quote}}')">
                <i class="fas fa-search"></i> Run Initial Vulnerability Analysis
            </button>
            <button class="btn btn-info btn-sm" onclick="viewManager.showVulnerabilityCacheStats()">
                <i class="fas fa-database"></i> Cache Stats
            </button>
            <button class="btn btn-warning btn-sm" onclick="viewManager.clearVulnerabilityCache()">
                <i class="fas fa-trash"></i> Clear Cache
            </button>
        </div>
        <div class="alert alert-info">
            <h6>ğŸ“‹ No Vulnerability Analysis Yet</h6>
            <p>This organization hasn't been analyzed for vulnerabilities yet. Click "Run Initial Vulnerability Analysis" to scan all dependencies for known vulnerabilities.</p>
            <p><strong>Note:</strong> This will query the OSV API for each dependency and may take a few minutes depending on the number of dependencies.</p>
        </div>
        {{/if}}
    </div>
</div>

