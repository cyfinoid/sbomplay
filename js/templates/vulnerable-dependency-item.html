<div class="vulnerable-dep-item mb-3" style="border-left: 3px solid #dc3545; padding-left: 15px;">
    <div class="vuln-dep-info">
        <div class="vuln-dep-name" style="font-weight: bold; font-size: 1.1em;">{{name|escape}}@{{version|escape}}</div>
        <div class="vuln-dep-count mb-2">{{vulnerabilityCount}} vulnerability{{vulnerabilityPlural}}</div>
        <div class="vuln-severity-badges mb-2">
            {{#each vulnerabilities}}
            <span class="badge severity-{{cssSeverity}} clickable-severity-badge me-1" 
                  title="{{tooltip|quote}}" 
                  onclick="viewManager.showVulnerabilityDetails('{{depName|quote}}', '{{depVersion|quote}}', [{{vulnJson|escape}}])">
                {{severity|escape}}
            </span>
            {{/each}}
        </div>
        {{#if hasUsage}}
        <div class="vuln-repo-usage mt-3 p-2 bg-light rounded">
            <small class="text-muted d-block mb-2">
                <i class="fas fa-code-branch me-1"></i>
                <strong>Used in {{uniqueReposCount}} repository{{reposPlural}}:</strong>
            </small>
            <div class="vuln-paths" style="font-size: 0.85em;">
                {{#each usage}}
                <div class="mb-2" style="padding-left: 10px;">
                    <code class="text-primary fw-bold">{{repoKey|escape}}</code>: <code>{{pathStr|escape}}</code>
                </div>
                {{/each}}
            </div>
        </div>
        {{else}}
        <div class="mt-2">
            <small class="text-muted">
                <i class="fas fa-info-circle me-1"></i>Repository usage information not available
            </small>
        </div>
        {{/if}}
    </div>
    <div class="vuln-dep-actions mt-2">
        <button class="btn btn-sm btn-outline-info" onclick="viewManager.showVulnerabilityDetails('{{name|quote}}', '{{version|quote}}', {{allVulnsJson|escape}})">
            <i class="fas fa-eye me-1"></i>View Details
        </button>
    </div>
</div>

